Script started on Fri Oct 20 08:55:07 2017
u286120@cse-ssh2[31]: cat 30[K-3.c
#include<stdio.h>
#include<stdlib.h>
#include<string.h>

#define DATANUM 54
#define IMAGEDATA 512
#define FILENAME 50

unsigned char header[DATANUM];
unsigned char imgin[3][IMAGEDATA][IMAGEDATA];
unsigned char imgout[3][IMAGEDATA][IMAGEDATA];

int filesize, offset, width, height, bits;

void get_data(void);
void put_data(void);
void processing(void);
//16é€²æ•°å¤‰æ› convert(headeré…åˆ—ã®æ·»å­—4ã¤)
//4ã¤ä»¥ä¸‹ã®å ´åˆã¯bmpã®äºˆç´„é ˜åŸŸã‚’å‰²ã‚Šå½“ã¦ã‚‹ã“ã¨)
int convert(int a, int b, int c, int d);

int main(void){
  get_data();
  processing();
  put_data();

  return 0;
}

void get_data(void){
  int c, i, j, k;
  char fileName[FILENAME];
  FILE *fp;

  printf("å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å…¥åŠ›ã—ã¦ä¸‹ã•ã„:");
  scanf("%s", fileName);

  fp = fopen(fileName, "rb");
  if(fp == NULL){
    printf("ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚ªãƒ¼ãƒ—ãƒ³ã§ãã¾ã›ã‚“ã§ã—ãŸ.\n");
    exit (1);
  }
  printf("ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚ªãƒ¼ãƒ—ãƒ³ã—ã¾ã—ãŸ.\n");

  //ãƒ˜ãƒƒãƒ€ãƒ¼å–å¾—
  c = fgetc(fp);
  for(i=0; i < DATANUM; i++){
    header[i] = c;
    c = fgetc(fp);
  }

  //ç”»åƒãƒ‡ãƒ¼ã‚¿å–å¾—
  for(i=3; i >= 0; i--){
    for(j=0; j <= 3; j++){
      for(k=2; k >= 0; k--){
	imgin[k][j][i] = c;
	c = fgetc(fp);
      }
    }
  }
  
  printf("ï¼œãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—ï¼\n");
  printf("header[0]=%02X header[1]=%02X\n\n", header[0], header[1]);

  printf("ï¼œãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºï¼\n");
  printf("header[2]=%02X header[3]=%02X header[4]=%02X header[5]=%02X\n",
	 header[2], header[3], header[4], header[5]);
  filesize = convert(2, 3, 4, 5);
  printf("%dãƒã‚¤ãƒˆ\n\n", filesize);

  printf("ï¼œäºˆç´„é ˜åŸŸï¼\n");
  printf("header[6]=%02X header[7]=%02X header[8]=%02X header[9]=%02X\n\n",
	 header[6], header[7], header[8], header[9]);

  printf("ï¼œã‚ªãƒ•ã‚»ãƒƒãƒˆï¼\n");
  printf("header[10]=%02X header[11]=%02X header[12]=%02X header[13]=%02X\n",
	 header[10], header[11], header[12], header[13]);
  offset = convert(10, 11, 12, 13);
  printf("%dãƒã‚¤ãƒˆ\n\n", offset);

  printf("ï¼œæƒ…å ±ãƒ˜ãƒƒãƒ€ã‚µã‚¤ã‚ºï¼\n");
  printf("header[14]=%02X header[15]=%02X header[16]=%02X header[17]=%02X\n\n",
	 header[14], header[15], header[16], header[17]);

  printf("ï¼œç”»åƒã®å¹…ï¼\n");
  printf("header[18]=%02X header[19]=%02X header[20]=%02X header[21]=%02X\n",
	 header[18], header[19], header[20], header[21]);
  width = convert(18, 19, 20, 21);
  printf("%dç”»ç´ \n\n", width);

  printf("ï¼œç”»åƒã®é«˜ã•ï¼\n");
  printf("header[22]=%02X header[23]=%02X header[24]=%02X header[25]=%02X\n",
	 header[22], header[23], header[24], header[25]);
  height = convert(22, 23, 24, 25);
  printf("%dãƒ©ã‚¤ãƒ³\n\n", height);

  printf("ï¼œè‰²ãƒ—ãƒ¬ãƒ¼ãƒ³æ•°ï¼\n");
  printf("header[26]=%02X header[27]=%02X\n\n", header[26], header[27]);

  printf("ï¼œ1ç”»ç´ å½“ãŸã‚Šã®ãƒ“ãƒƒãƒˆæ•°ï¼\n");
  printf("header[28]=%02X header[29]=%02X\n", header[28], header[29]);
  bits = convert(28, 29, 6, 6);
  printf("%dãƒ“ãƒƒãƒˆ\n\n", bits);

  printf("ï¼œåœ§ç¸®æ–¹å¼ï¼\n");
  printf("header[30]=%02X header[31]=%02X header[32]=%02X header[33]=%02X\n\n",
	 header[30], header[31], header[32], header[33]);

  printf("ï¼œç”»åƒãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºï¼\n");
  printf("header[34]=%02X header[35]=%02X header[36]=%02X header[37]=%02X\n\n",
	 header[34], header[35], header[36], header[37]);

  printf("ï¼œæ°´å¹³è§£åƒåº¦ï¼\n");
  printf("header[38]=%02X header[39]=%02X header[40]=%02X header[41]=%02X\n\n",
	 header[38], header[39], header[40], header[41]);

  printf("ï¼œå‚ç›´è§£åƒåº¦ï¼\n");
  printf("header[42]=%02X header[43]=%02X header[44]=%02X header[45]=%02X\n\n",
	 header[42], header[43], header[44], header[45]);

  printf("ï¼œè‰²æ•°ï¼\n");
  printf("header[46]=%02X header[47]=%02X header[48]=%02X header[49]=%02X\n\n",
	 header[38], header[39], header[40], header[41]);

  printf("ï¼œé‡è¦ãªè‰²æ•°ï¼\n");
  printf("header[50]=%02X header[51]=%02X header[52]=%02X header[53]=%02X\n\n",
	  header[50], header[51], header[52], header[53]);

  printf("ï¼œæŒ¿å…¥ãƒ“ãƒƒãƒˆæ•°ï¼\n");
  printf("%dãƒã‚¤ãƒˆ\n\n", filesize-offset-width*height*(bits/8));

  fclose(fp);
  printf("ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¯ãƒ­ãƒ¼ã‚ºã—ã¾ã—ãŸ.\n");
}

void processing(void){
  int i,j,k;

  printf("å…¥åŠ›ç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¾ã™.\n\n");

  printf("%02X\n", imgin[0][1][0]);

  printf("ï¼œRä¿¡å·ï¼\n");
  i = 0;
  for(j=0; j<width; j++){
    for(k=0; k<height; k++){
      printf("%02X ", imgin[i][k][j]);
    }
    printf("\n");
  }

  printf("ï¼œGä¿¡å·ï¼\n");
  i = 1;
  for(j=0; j<width; j++){
    for(k=0; k<height; k++){
      printf("%02X ", imgin[i][k][j]);
    }
    printf("\n");
  }

  printf("ï¼œBä¿¡å·ï¼\n");
  i = 2;
  for(j=0; j<width; j++){
    for(k=0; k<height; k++){
      printf("%02X ", imgin[i][k][j]);
    }
    printf("\n");
  }

  for(i=0; i<3; i++){
    for(j=0; j<IMAGEDATA; j++){
      for(k=0; k<IMAGEDATA; k++){
	imgout[i][j][k] = imgin[i][j][k];
      }
    }
  }
  printf("\nå‡ºåŠ›ç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¾ã—ãŸ.\n");

}

void put_data(void){
  int i, j, k;
  char fileName[FILENAME];
  FILE *fp;

  printf("å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å…¥åŠ›ã—ã¦ä¸‹ã•ã„:");
  scanf("%s", fileName);

  fp = fopen(fileName, "wb");
  if(fp == NULL){
    printf("ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚ªãƒ¼ãƒ—ãƒ³ã§ãã¾ã›ã‚“ã§ã—ãŸ.\n");
    exit (1);
  }
  printf("ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚ªãƒ¼ãƒ—ãƒ³ã—ã¾ã—ãŸ.\n");

  for(i=0; i<3; i++){
    for(j=0; j<IMAGEDATA; j++){
      for(k=0; k<IMAGEDATA; k++){
	fputc(imgout[i][j][k], fp);
      }
    }
  }
  
  
  fclose(fp);
  printf("ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¯ãƒ­ãƒ¼ã‚ºã—ã¾ã—ãŸ.\n");
  
}

int convert(int a, int b, int c, int d){
  char cSum[100];
  sprintf(cSum, "%02X%02X%02X%02X",
	 header[d], header[c], header[b], header[a] );
  return (int)strtol(cSum, NULL, 16);
}
u286120@cse-ssh2[32]: gcc -Wall -o 3-3 3-3.c
u286120@cse-ssh2[33]: -3[K[K3-3
å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å…¥åŠ›ã—ã¦ä¸‹ã•ã„:testimg.bmp
ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚ªãƒ¼ãƒ—ãƒ³ã—ã¾ã—ãŸ.
ï¼œãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—ï¼
header[0]=42 header[1]=4D

ï¼œãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºï¼
header[2]=68 header[3]=00 header[4]=00 header[5]=00
104ãƒã‚¤ãƒˆ

ï¼œäºˆç´„é ˜åŸŸï¼
header[6]=00 header[7]=00 header[8]=00 header[9]=00

ï¼œã‚ªãƒ•ã‚»ãƒƒãƒˆï¼
header[10]=36 header[11]=00 header[12]=00 header[13]=00
54ãƒã‚¤ãƒˆ

ï¼œæƒ…å ±ãƒ˜ãƒƒãƒ€ã‚µã‚¤ã‚ºï¼
header[14]=28 header[15]=00 header[16]=00 header[17]=00

ï¼œç”»åƒã®å¹…ï¼
header[18]=04 header[19]=00 header[20]=00 header[21]=00
4ç”»ç´ 

ï¼œç”»åƒã®é«˜ã•ï¼
header[22]=04 header[23]=00 header[24]=00 header[25]=00
4ãƒ©ã‚¤ãƒ³

ï¼œè‰²ãƒ—ãƒ¬ãƒ¼ãƒ³æ•°ï¼
header[26]=01 header[27]=00

ï¼œ1ç”»ç´ å½“ãŸã‚Šã®ãƒ“ãƒƒãƒˆæ•°ï¼
header[28]=18 header[29]=00
24ãƒ“ãƒƒãƒˆ

ï¼œåœ§ç¸®æ–¹å¼ï¼
header[30]=00 header[31]=00 header[32]=00 header[33]=00

ï¼œç”»åƒãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºï¼
header[34]=32 header[35]=00 header[36]=00 header[37]=00

ï¼œæ°´å¹³è§£åƒåº¦ï¼
header[38]=12 header[39]=0B header[40]=00 header[41]=00

ï¼œå‚ç›´è§£åƒåº¦ï¼
header[42]=12 header[43]=0B header[44]=00 header[45]=00

ï¼œè‰²æ•°ï¼
header[46]=12 header[47]=0B header[48]=00 header[49]=00

ï¼œé‡è¦ãªè‰²æ•°ï¼
header[50]=00 header[51]=00 header[52]=00 header[53]=00

ï¼œæŒ¿å…¥ãƒ“ãƒƒãƒˆæ•°ï¼
2ãƒã‚¤ãƒˆ

ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¯ãƒ­ãƒ¼ã‚ºã—ã¾ã—ãŸ.
å…¥åŠ›ç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¾ã™.

01
ï¼œRä¿¡å·ï¼
00 01 02 03 
04 05 06 07 
08 09 0A 0B 
0C 0D 0E 0F 
ï¼œGä¿¡å·ï¼
10 11 12 13 
14 15 16 17 
18 19 1A 1B 
1C 1D 1E 1F 
ï¼œBä¿¡å·ï¼
20 21 22 23 
24 25 26 27 
28 29 2A 2B 
2C 2D 2E 2F 

å‡ºåŠ›ç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¾ã—ãŸ.
å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å…¥åŠ›ã—ã¦ä¸‹ã•ã„:testcp.bmp
ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚ªãƒ¼ãƒ—ãƒ³ã—ã¾ã—ãŸ.
ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¯ãƒ­ãƒ¼ã‚ºã—ã¾ã—ãŸ.
u286120@cse-ssh2[34]: exit
exit

Script done on Fri Oct 20 08:55:41 2017
